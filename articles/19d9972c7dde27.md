---
title: "Quickfix ã«è§¦ã‚Œã¦ã¿ã‚ˆã†"
emoji: "ğŸ”—"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Vim", "Neovim"]
published: true
---

:::message
ğŸ„ ã“ã®è¨˜äº‹ã¯ Vim advent calender 2022 (2) ã® 2 æ—¥ç›®ã®è¨˜äº‹ã§ã™ ğŸ
https://qiita.com/advent-calendar/2022/vim

[æ˜¨æ—¥ã®è¨˜äº‹ - Vimã§ç©ºè¡ŒæŒ¿å…¥+dot repeat](https://zenn.dev/vim_jp/articles/8de697fc88e63c)
:::

# ã¯ã˜ã‚ã«
Quickfix ã‚’ä½¿ã„å§‹ã‚ã¦ vim ã®ç´ æ™´ã‚‰ã—ã•ã‚’ã•ã‚‰ã«å®Ÿæ„Ÿã§ããŸã®ã§ã€ã¾ã çŸ¥ã‚‰ãªã„æ–¹ã«ã“ã®æ„Ÿå‹•ã‚’å±Šã‘ãŸãã¦è¨˜äº‹ã«ã—ã¾ã—ãŸ
ç§ã‚‚å…¨ç„¶ä½¿ã„ã“ãªã›ã¦ã¯ã„ã¾ã›ã‚“ãŒã€åˆã‚ã¦ã®æ–¹ãŒ Quickfix ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ãã£ã‹ã‘ã«ãªã‚Œã°å¬‰ã—ã„ã§ã™


# Quickfix ã¨ã¯

[:quickfix](https://vim-jp.org/vimdoc-ja/quickfix.html) ã¨ã¯
> Vimã«ã¯ç·¨é›†-ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«-ç·¨é›†ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’åŠ é€Ÿã™ã‚‹ãŸã‚ã®ç‰¹åˆ¥ãªãƒ¢ãƒ¼ãƒ‰ãŒã‚ã‚‹ã€‚ã“ã‚Œ ã¯Amigaã®Manx's Aztec C compilerã®quickfixã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã‚¤ãƒ³ã‚¹ãƒ‘ã‚¤ã‚¢ã•ã‚ŒãŸã€‚
> Cã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‹ã‚‰å‡ºåŠ›ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã—ã€Vimã§ãã®ã‚¨ãƒ©ãƒ¼ã«ã‚¸ãƒ£ãƒ³ãƒ—ã™ã‚‹ã¨ã„ã†ã‚¢ã‚¤ãƒ‡ã‚¢ã§ã‚ã‚‹ã€‚
> ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¨éƒ¨è¦šãˆã¦ãŠã‹ãªãã¦ã‚‚ã€ãã‚Œãã‚Œã®å•é¡Œã‚’æ¤œè¨¼ã—ã€ä¿®æ­£ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
> quickfixã‚³ãƒãƒ³ãƒ‰ã¯ã‚ˆã‚Šä¸€èˆ¬çš„ã«ã€ãƒ•ã‚¡ã‚¤ãƒ«ä¸­ã®ä½ç½®ã®ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã€ã‚¸ãƒ£ãƒ³ãƒ—ã™ã‚‹ãŸã‚ã«ä½¿ã†ã“ã¨ãŒã§ãã‚‹ã€‚

è¦ç´„ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã‚„æ¤œç´¢ä½ç½®ã«ã´ã‚‡ã‚“ã´ã‚‡ã‚“é£›ã¹ã‚‹æ©Ÿèƒ½ã§ã™

see: [:help quickfix](https://vim-jp.org/vimdoc-ja/quickfix.html), [:help 30.1](https://vim-jp.org/vimdoc-ja/usr_30.html#30.1)


# Quickfix ã‚’ä½¿ã£ã¦ã¿ã‚ˆã†

ç¿’ã†ã‚ˆã‚Šæ…£ã‚Œã‚ã¨ã„ã†ã“ã¨ã§ã©ã‚“ã©ã‚“ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†

## vimgrep ç·¨

[:vimgrep](https://vim-jp.org/vimdoc-ja/quickfix.html#:vimgrep) ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ã”å­˜çŸ¥ã§ã—ã‚‡ã†ã‹ï¼Ÿ
ç§ã¯æœ€åˆ `/` ã®æ¤œç´¢ã—ã‹çŸ¥ã‚‰ãš vim ã‚’é–‰ã˜ã¦ grep ã—ã¦ã¾ãŸ vim ã«æˆ»ã£ã¦ã¨å¤§å¤‰ã§ã—ãŸ
[:vimgrep](https://vim-jp.org/vimdoc-ja/quickfix.html#:vimgrep) ã‚’ä½¿ã†ã¨ vim ã®ä¸­ã‹ã‚‰ grep ã‚’å®Ÿè¡Œã—ã¦çµæœã‚’ quickfix window ã«é€ã‚‹ã“ã¨ãŒã§ãã¾ã™
`:vimgrep /{pattern}/ {file}` ãŒåŸºæœ¬ã®å½¢ã§ã™
`{file}` ã«ã¯ glob ã‚‚ä½¿ãˆã‚‹ã®ã§ `src/**/*.ts` ã®ã‚ˆã†ã«ä½¿ã†ã“ã¨ã‚‚ã§ãã¾ã™

quickfix ã®ä¸­èº«ã‚’è¦‹ã‚‹ã«ã¯ [:cwindow](https://vim-jp.org/vimdoc-ja/quickfix.html#:cwindow) ã‚’å®Ÿè¡Œã—ã¾ã™
quickfix window ã®ãƒªã‚¹ãƒˆã®ä¸Šã§ Ender ã‚’æŠ¼ã™ã¨çµæœä½ç½®ã«é£›ã¶ã“ã¨ãŒã§ãã¾ã™
å®Ÿéš›ã«ã‚„ã£ã¦ã¿ã¾ã—ã‚‡ã†

```shell
$ curl -OL https://raw.githubusercontent.com/MikhaD/wordle/main/src/words_5.ts # wordle ã®ãƒ¯ãƒ¼ãƒ‰ãŒæ›¸ã‹ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ DL
$ vim words_5.ts                                                               # DL ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ vim ã§é–‹ã
```
```vim
:vimgrep 'vi' % " vimgrep ã‚³ãƒãƒ³ãƒ‰ã§æ–‡å­—åˆ— vi ã‚’ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ¤œç´¢
:cwindow      " quickfix window ã‚’é–‹ã
```

### :grep
[:vimgrep](https://vim-jp.org/vimdoc-ja/quickfix.html#:vimgrep) ã¯é…ã„ã®ã§ [:grep](https://vim-jp.org/vimdoc-ja/quickfix.html#:grep) ã‚’ä½¿ã†ã¨è‰¯ã„ã§ã—ã‚‡ã†
ã»ã¨ã‚“ã©åŒã˜ã‚ˆã†ã«ä½¿ãˆã¾ã™ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ `grep -n` ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ãŒ [grepprg](https://vim-jp.org/vimdoc-ja/options.html#'grepprg') ã§å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™
ãŠã™ã™ã‚ã¯ [ripgrep](https://github.com/BurntSushi/ripgrep) ã‚’ä½¿ã†ã“ã¨ã§ã™
ä»¥ä¸‹ã‚’ `init.vim` ã«æ›¸ãã¨è‰¯ã„ã§ã—ã‚‡ã†
```vim
set grepprg=rg\ --vimgrep
```
ã¾ãŸã€å‡ºåŠ›ã¯ [grepformat](https://vim-jp.org/vimdoc-ja/options.html#'grepformat') ã§ãƒ‘ãƒ¼ã‚¹ã•ã‚Œã¾ã™

## make ç·¨
[:make](https://vim-jp.org/vimdoc-ja/quickfix.html#:make)
C compiler ã«ã‚¤ãƒ³ã‚¹ãƒ‘ã‚¤ã‚¢ã•ã‚ŒãŸãã†ãªã®ã§ã€ã¾ãš C++ ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ clone ã—ã¦ãã¾ã™
[Cpp-Tutorial-Samples](https://github.com/sinairv/Cpp-Tutorial-Samples)
ãã—ã¦é©å½“ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ `vim` ã§é–‹ãã¾ã—ã‚‡ã†
```shell
$ git clone https://github.com/sinairv/Cpp-Tutorial-Samples.git
$ cd Cpp-Tutorial-Samples/Arrays/Arrays/
$ vim Prog.cpp
```
```vim
:make
:cw
```
make ã¯æˆåŠŸã™ã‚‹ã®ã§ã‚‚ã¡ã‚ã‚“ quickfix window ã¯ç©ºã§ã™
ã‚»ãƒŸã‚³ãƒ­ãƒ³ã‚’æ¶ˆã—ãŸã‚Šã€å¤‰æ•°åã‚’ä¸€éƒ¨ã ã‘å¤‰ãˆã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒå¤±æ•—ã™ã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™
ãã—ã¦ `:make` ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒ quickfix window ã«è¡¨ç¤ºã•ã‚Œã¾ã™
[:make](https://vim-jp.org/vimdoc-ja/quickfix.html#:make) ã¯ [makeprg](https://vim-jp.org/vimdoc-ja/options.html#'grepprg') ã‚’å®Ÿè¡Œã—ã¾ã™
`makeprg` ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ `make` ãªã®ã§ `vim` ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã®ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« Makefile ãŒã‚ã‚Œã°ç‰¹ã«è¨­å®šã‚’å¤‰æ›´ã›ãšã«å®Ÿè¡Œã§ãã¾ã™
ã¾ãŸã€å‡ºåŠ›ã¯ [errorformat](https://vim-jp.org/vimdoc-ja/options.html#'errorformat') ã§ãƒ‘ãƒ¼ã‚¹ã•ã‚Œã¾ã™

### :compiler
`makeprg` ã‚„ `errorformat` ã‚’è¨­å®šã™ã‚‹ã®ã¯éå¸¸ã«é¢å€’ã§ã™
ãã“ã§ [:compiler](https://vim-jp.org/vimdoc-ja/quickfix.html#:compiler) ã®å‡ºç•ªã§ã™
[Vim](https://github.com/vim/vim/tree/master/runtime/compiler) ã‚‚ [Neovim](https://github.com/vim/vim/tree/master/runtime/compiler) ã‚‚ `runtime/compiler` é…ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦ make ã®è¨­å®šã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™
`tsc` ã‚’ä¾‹ã«ã‚ã’ã¦å®Ÿéš›ã«ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†

```shell
$ pnpm init && pnpm add typescript
$ echo 'let i:string = '';\n i = 10;' > test.ts
```
```vim
:compiler tsc
:set makeprg=pnpm\ exec\ tsc\ %
:make
```

:::message
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ã® tsc ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™
ã¾ãŸã€å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ tsconfig ã§ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¯æŒ‡å®šã™ã‚‹ã¯ãšãªã®ã§æœ€å¾Œã® % ã¯ä¸è¦ã«ãªã‚‹å ´åˆãŒå¤šã„ã§ã—ã‚‡ã†
:::

## plugin ç·¨
åŠ›å°½ããŸã®ã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ä¸€è¦§å½¢å¼ã§ã®ç´¹ä»‹ã«ç•™ã‚ã¾ã™

- [thinca/vim-quickrun](https://github.com/thinca/vim-quickrun)
`:make` ã ã¨åŒæœŸå‡¦ç†ãªã®ã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ã£ã¦éåŒæœŸã«ã™ã‚‹ã®ãŒãŠã™ã™ã‚ã§ã™ (ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ¨¡ç´¢ä¸­ã§ã™)
- [nvim-telescope/telescope.nvim](https://github.com/nvim-telescope/telescope.nvim) (Neovimé™å®š)
fuzzy-finder ã§ã™ æ¤œç´¢æ™‚ `C-q` ã§ Quickfix List ã«æŒã£ã¦æ¥ã‚‹ã“ã¨ãŒã§ãã¾ã™ `:Telescope quickfix` ã¨ã‹ã‚‚ä¾¿åˆ©

ã“ã®è¾ºã‚‚è¦‹ã‚‹ã¨ã„ã„ã‹ã‚‚
https://github.com/yutkat/my-neovim-pluginlist#quickfix

### ä½¿ã£ãŸã“ã¨ãªã„ã‘ã©æ°—ã«ãªã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³(Neovimé™å®š)
- [kevinhwang91/nvim-bqf](https://github.com/kevinhwang91/nvim-bqf)
Quickfix List ã® UI ãŒãƒªãƒƒãƒã«ãªã‚Šã¾ã™
- [is0n/jaq-nvim](https://github.com/is0n/jaq-nvim)
quickrun ã®äºœç¨®
- [onsails/diaglist.nvim](https://github.com/onsails/diaglist.nvim)
lsp ã¨é€£æºã—ã¦ diagnostics ã‚’ quickfix ã«å…¥ã‚Œã¦ãã‚Œã‚‹


# Quickfix List ã‚’ä½¿ã„ã“ãªãã†
## å‰å¾Œã®é …ç›®ã«ç§»å‹•ã™ã‚‹
- [:cprev](https://vim-jp.org/vimdoc-ja/quickfix.html#:cprev) å‰ã®é …ç›®
- [:cnext](https://vim-jp.org/vimdoc-ja/quickfix.html#:cnext) æ¬¡ã®é …ç›®
## Quickfix List ã‚’ç§»å‹•ã™ã‚‹
- [:colder](https://vim-jp.org/vimdoc-ja/quickfix.html#:colder) å¤ã„ãƒªã‚¹ãƒˆ
- [:cnewer](https://vim-jp.org/vimdoc-ja/quickfix.html#:cnewer) æ–°ã—ã„ãƒªã‚¹ãƒˆ
## Quickfix List ã®å…¨ã¦ã®é …ç›®ã«å¯¾ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹
[:cdo](https://vim-jp.org/vimdoc-ja/quickfix.html#:cdo) ã¯ Quickfix List ã®å…¨ã¦ã®é …ç›®ã«å¯¾ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™
ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ Quickfix List ã®å…¨ã¦ã®è¡Œã§ hoge ã‚’ fuga ã«ç½®æ›ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°ã—ã¾ã™
```vim
:cdo s/hoge/fuga/g | update
```
## grep, make ã®å¾Œã«è‡ªå‹•ã§ quickfix window ã‚’é–‹ã
```vim
autocmd QuickFixCmdPost *grep* cwindow
autocmd QuickFixCmdPost *make* cwindow
```

# çµ‚ã‚ã‚Šã«

vim ã§ grep, make ã‚’ã‚„ã‚‹ã¨ãã«ã¯ Quickfix ã‚’æ´»ç”¨ã™ã‚‹ã¨ä¾¿åˆ©ã§ã™
:make ã§ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã ã‘ã§ãªããƒ†ã‚¹ãƒˆã®å®Ÿè¡Œãªã©ã‚‚ã§ãã‚‹ã®ã§æ˜¯éæ´»ç”¨ã—ãŸã„ã§ã™ã­
ä»Šæ›´æ°—ã¥ã„ãŸã®ã§ã™ãŒã€å»å¹´ã‚‚[åŒã˜ã‚ˆã†ãªè¨˜äº‹](https://zenn.dev/tmrekk/articles/4380961a754287)ãŒã‚ã£ãŸã‚“ã§ã™ã­ orz
ä½•åº¦ã‚‚å‡ºã‚‹ã¨ã„ã†ã“ã¨ã¯ãã‚Œã ã‘ä¾¿åˆ©ã¨ã„ã†ã“ã¨ã§ã€ãœã²ä½¿ã„ã“ãªã›ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ã‚‡ã†ï¼
æ˜æ—¥ã¯ ryicoh ã•ã‚“ã® `ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãªã—ã§Vimã‚’ä½¿ã†ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯` ã§ã™


# å‚è€ƒæ–‡çŒ®
ã“ã®è¾ºã®è¨˜äº‹ã‚’å‚è€ƒã«ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸ
ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™

- https://vim-jp.org/vimdoc-ja/quickfix.html
- https://www.soum.co.jp/misc/vim-no-susume/7/
- https://daisuzu.hatenablog.com/entry/2020/12/03/003629
- https://qiita.com/yuku_t/items/0c1aff03949cb1b8fe6b
- https://zenn.dev/tmrekk/articles/4380961a754287
